# HTTPS, TLS 

## TLS, SSL

TLS와 SSL은 동일 (명칭의 차이, 그래도 TLS라고 부르는 것이 맞음)

### SSL(Secure Socket Layer)

SSL 1.0, SSL 2.0, SSL 3.0, TLS 1.0, TLS 1.3까지 버전이 올라가며 TLS로 명칭이 변경

### TLS(TransportLayer Security Protocol)

전송 계층에서 보안을 제공하는 프로토콜  
클라이언트와 서버가 통신할 때 TLS를 통해 제3자가 메시지를 도청하거나 변조하지 못하도록 함 

<br><br>

## TLS 핸드쉐이크

어떻게 암호화된 통신을 하는가의 기초가 되는 것이 TLS 핸드쉐이크 과정   

![](../Images/TLS_핸드셰이크.png)

* 1-RTT로 인증 작업 수행
* 인증 작업에서 **비대칭 암호화 (공개키 암호화)**
    * 비용이 많이 들어서(연산 작업이 더 필요하기 때문) 인증 후에 대칭 암호화로 전환
    * 엄격한 인증이 필요해서 비대칭 암호화 사용
* 인증이 끝나면 **대칭 암호화**

<br>

### TLS 핸드쉐이크 과정

> 📌 사용할 TLS버전을 정하고, 사이퍼슈트, 서버의 공개키, SSL인증서를 기반으로 인증작업을 수행  
> 이 후 대칭 암호화를 위해 세션키를 생성  

1. `Client Hello`  
클라이언트는 TLS버전, **사이퍼슈트**와 클라이언트 랜덤값(무작위 문자열), **임시 DH 매개변수**를 서버에게 보냄


2. `Server Hello, EncryptedExtensions, Certificate, CertificateVerify`  
서버는 클라이언트로부터 받은 옵션을 확인    
서버와 클라이언트 모두에서 지원하는 가장 높은 TLS 버전을 식별하며 결정, 사이퍼슈트 지원 여부를 확인  
공개키가 포함된 SSL 인증서, 서버 랜덤값(무작위 문자열), 임시 DH 매개변수를 보냄    
클라이언트와 서버 각각 서로 교환한 DH 매개변수를 사용하여 **임시 암호 키(세션키)** 생성


3. `Finished`  
클라이언트와 서버와 **세션키를 기반으로 대칭 암호화된 통신**이 시작( = 보안세션이 시작됨)
   * 키교환 알고리즘 : 대표적으로 RSA와 DH  
   DH를 기반으로 하며, **타원곡선 DH**를 사용    
   cf. TLS1.3버전에서는 RSA의 경우 취약점이 있기 때문에 공식적으로 지원하지 않음
   
<br>

### DH 매개변수 (DH = Diffie-Hellman)

![](../Images/DH매개변수.jpeg)

#### Diffie-Hellman 알고리즘 

1. 서로 공개값을 공유
2. 각자의 비밀값과 혼합
3. 서로 혼합값을 공유
4. 각자의 비밀값과 혼합
5. 공통의 암호키를 생성  

#### DH 종류 

1. DHE : 그냥 디피헬만을 사용
2. ECDHE : 타원곡선 암호화 방법과 DH를 섞음 
   * 주로 사용됨 
   

### 타원곡선 암호화 방법

![](../Images/타원곡선암호화.png)

보완성 강화 

곡선을 사용해 개인 키 보유자만 알 수 있는 타원곡선을 그린 후, 이것을 기반으로 교차점을 생성  
이 교차점의 수를 기반으로 암호를 설정하는 방법  


