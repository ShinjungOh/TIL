# Next 

## NextAuth

ì§ì ‘ êµ¬í˜„í•´ë„ ë˜ì§€ë§Œ, ë„¥ìŠ¤íŠ¸ì—ì„  NextAuthë¥¼ ë§ì´ ì‚¬ìš©    
ìµœê·¼ì— Auth.jsë¡œ ì´ë¦„ì´ ë°”ë€œ 

ë„¥ìŠ¤íŠ¸, ìŠ¤ë²¨íŠ¸, ì†”ë¦¬ë“œ ë“±ë„ ì§€ì›

### ì¥ì  

#### 1. Login Providers, ë‹¤ì–‘í•œ ë¡œê·¸ì¸ ì§€ì›
> https://authjs.dev/getting-started/providers  

ì¹´ì¹´ì˜¤, ë„¤ì´ë²„, êµ¬ê¸€, ì¸ìŠ¤íƒ€ê·¸ë¨ ë“± ë‹¤ì–‘í•œ ì†Œì…œ ë¡œê·¸ì¸ ì§€ì›  
ê°„í¸ ë¡œê·¸ì¸ êµ¬í˜„í•˜ê¸° í¸í•¨

#### 2. Credentials Provider
> https://authjs.dev/guides/providers/credentials

ê¸°ë³¸ì ì¸ ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸ë„ ì§€ì›  

#### 3. ë¡œê·¸ì¸ì— ë”°ë¥¸ ì¿ í‚¤ ë“±ì„ ê´€ë¦¬í•´ì¤Œ

<br><br>

## NextAuthë¡œ ë¡œê·¸ì¸ êµ¬í˜„í•˜ê¸°

### 1. `auth.ts`, `middleware.ts` íŒŒì¼ ìƒì„±

app ë””ë ‰í† ë¦¬ì™€ ê°™ì€ ìœ„ì¹˜ì— íŒŒì¼ ìƒì„± 

<br>

### 2. next-auth ì„¤ì¹˜

```bash
npm i next-auth@5

# 5ë²„ì „ì´ ì•„ì§ ì•ˆë‚˜ì™”ì„ ê²½ìš° 
npm i next-auth@beta
```

```bash
# ì—­ì‹œ 5ë²„ì „ì´ ì•„ì§ ì•ˆ ë‚˜ì™”ìœ¼ë©´ beta
npm i next-auth@beta @auth/core 
```

> ğŸš¨ **500 ì„œë²„ ì—ëŸ¬ê°€ ë°œìƒí•  ë•Œ í•´ê²° ë°©ë²•**
> 
> `package.json`ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì„ ë‚®ì¶”ê¸°
> * next-auth ì‚­ì œ 
> * npm i next-auth@5.0.0-beta.3 ì„¤ì¹˜

```
â€œ@auth/coreâ€: â€œ^0.19.0", 
â€œnextâ€: â€œ^14", 
â€œnext-authâ€: â€œ^5.0.0-beta.3", 
â€œreactâ€: â€œ^18", 
â€œreact-domâ€: â€œ^18"
```

<br>

### 3. `auth.ts` íŒŒì¼ ë‚´ìš© ì‘ì„±

```ts
import NextAuth from "next-auth";
import CredentialsProvider from "next-auth/providers/credentials"

export const {
    handlers: {GET, POST},
    auth,
    signIn,
} = NextAuth({
  pages: {},
})
```

* ê¸°ë³¸ì ì¸ í‹€ 

<br>

### 4. `middleware.ts` íŒŒì¼ ë‚´ìš© ì‘ì„±  

* `auth.ts`ì˜ authë¥¼ ë¶ˆëŸ¬ì™€ì„œ ë¯¸ë“¤ì›¨ì–´ ì—­í• ì„ í•˜ë„ë¡ í•¨
* `config`ëŠ” ë¯¸ë“¤ì›¨ì–´ë¥¼ ì ìš©í•  route
  * ë¯¸ë“¤ì›¨ì–´ ì ìš©í•  route ëª©ë¡ì„ matchersì— ì ìœ¼ë©´ ë¨
  * ë¯¸ë“¤ì›¨ì–´ëŠ” ë„¥ìŠ¤íŠ¸ì—ì„œ ê³µì‹ì ìœ¼ë¡œ ì§€ì›í•˜ëŠ” ê¸°ëŠ¥

```ts
export { auth as middleware } from "./auth"

export const config = {
  matchers: ['/compost/tweet', '/home', 'explore', 'messages', '/search'],
}
```

* ë¡œê·¸ì¸ í•´ì•¼ ë³´ì´ëŠ” í˜ì´ì§€ë“¤(ë¯¸ë¡œê·¸ì¸ ì‹œ ë“¤ì–´ê°€ì§€ëŠ”/ì•ˆ ë“¤ì–´ê°€ì§€ëŠ” í˜ì´ì§€ êµ¬ë¶„) ì²˜ë¦¬ 
* Ex. íŠ¸ìœ„í„°ì—ì„œëŠ” ë¯¸ë¡œê·¸ì¸ ì‹œ, ë©”ë‰´ê°€ ë¹„ì–´ìˆê³  íŠ¸ë Œë“œë„ ë³¼ ìˆ˜ ì—†ìŒ

<br>

> í˜ì´ì§€ ë¼ìš°í„° ì‹œì ˆì—ëŠ” í˜ì´ì§€ì— ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ” ìœ ì €ë¥¼ ì²˜ë¦¬í•˜ê¸° ì–´ë ¤ì› ìŒ   
> ë„¥ìŠ¤íŠ¸ì—ì„œëŠ” **ë¯¸ë“¤ì›¨ì–´** ê¸°ëŠ¥ì„ ì§€ì›í•¨ì— ë”°ë¼ ê·¸ëŸ° ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ìˆê²Œë¨ 
> * ì•± ë¼ìš°í„°ì—ì„œëŠ” ë¯¸ë“¤ì›¨ì–´ë¥¼ í™œìš©í•´ì„œ í˜ì´ì§€ ì ‘ê·¼ ê¶Œí•œ ë“±ì„ ê´€ë¦¬í•˜ê¸°ê°€ ì‰¬ì›Œì§ 
> * `middleware.ts`ì—ì„œ ë¯¸ë“¤ì›¨ì–´ í•¨ìˆ˜ë¥¼ ë§Œë“¤ê³ , ë¡œê·¸ì¸í•œ ì‚¬ëŒë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë“±ì˜ ë¡œì§ êµ¬í˜„ 
> * ë§¤ì²˜ì— í•´ë‹¹ë˜ëŠ” ë¼ìš°íŠ¸ì—ì„œëŠ” ì´ í•¨ìˆ˜ê°€ í˜ì´ì§€ ë Œë”ë§ ë˜ê¸° ì „ì— ì‹¤í–‰ë¨ 

#### ë¯¸ë“¤ì›¨ì–´ í•¨ìˆ˜

```
export { auth as middleware } from "./auth"
```

* ë¯¸ë“¤ì›¨ì–´ í•¨ìˆ˜ë¥¼ ì•ˆ ë§Œë“¤ì–´ë„ export function middlewareê°€ ë¨
* `auth.ts`ì—ì„œ ë§Œë“¤ì–´ ë†“ì€ ë¯¸ë“¤ì›¨ì–´ í•¨ìˆ˜ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©

<br><br>

## ì°¸ê³  ì‚¬ì´íŠ¸ 

> êµ¬ë²„ì „ https://next-auth.js.org/  
> ì‹ ë²„ì „(V5) https://authjs.dev/  
> ë¯¸ë“¤ì›¨ì–´ https://nextjs.org/docs/app/building-your-application/routing/middleware

<br><br>
